!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5f58e17d-1028-4809-b8c9-f67ca9b39f52",e._sentryDebugIdIdentifier="sentry-dbid-5f58e17d-1028-4809-b8c9-f67ca9b39f52")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"52b255b5cc5c7fe9748201022c25eac6092639d0"},(()=>{"use strict";const e=(e,t,i)=>{console.debug(`${i} TSS: hosted page injected`),console.debug(`${i} MBTSS: Nonce: `,e);let o=!1,n=!1,s={},r={},a={},c={};function d({object:t,f:i,subtype:s,detectFunc:r,proxy:a=l,isBrowserlocker:c=!0}){let d=t[i];t[i]=function(){if(o&&!n&&c)throw new Error("Breaking Browser Locker Behavior detected");let t=[].slice.call(arguments);if(!n&&r(t)&&(o=!0),o&&!n&&function(t,i){window.top.postMessage(JSON.parse(JSON.stringify({type:"scam",subtype:t,parameters:i,nonce:e})),"*")}(s,t),o&&!n&&c)throw new Error("Breaking Browser Locker Behavior detected");return a(d,this,t)}}function l(e,t,i){return e.apply(t,i)}function u(e,i,o){return t(e,i,o)}function p(e){return console.debug("TSS: Counted history being replaced"),b()}function b(e){return console.debug("TSS: Caught history"),u(s,1e3,500)}d({object:window,f:"print",subtype:"printLoop",detectFunc:function(e){return console.debug("TSS: caught print"),u(r,1e4,3)}}),d({object:window.history,f:"pushState",subtype:"historyLoop",detectFunc:function(e){return console.debug("TSS: Counted history being pushed"),b()}}),window.setTimeout((function(){d({object:window.history,f:"replaceState",subtype:"historyLoop",detectFunc:p})}),2e3),d({object:URL,f:"createObjectURL",subtype:"createURLLoop",detectFunc:function(e){return console.debug("TSS: Caught create URL"),u(a,1e3,500)}}),window.chrome&&window.chrome.webstore&&d({object:chrome.webstore,f:"install",subtype:"extensionInstall",detectFunc:function(e){return console.debug("TSS: Caught webstore install"),!0},isBrowserlocker:!1}),window.Notification&&d({object:window.Notification,f:"requestPermission",subtype:"notificationLoop",detectFunc:function(e){return console.debug("TSS: Caught notification permission request"),u(c,5e3,2)},isBrowserlocker:!1}),window.addEventListener("message",(function(t){t.source===window&&t.data.nonce===e&&"exclude"===t.data.type&&(n=!0)}),!1)};Object.freeze({LicenseStateUnknown:0,LicenseStateFree:1,LicenseStateTrial:2,LicenseStateTrialExpired:3,LicenseStateLicensed:4,LicenseStateLicenseExpired:5,LicenseStateLicenseGrace:6}),Object.freeze([2,4,6]),Object.freeze({MALWARE:Object.freeze({type:"malware",FULL_URL_MALWARE:"full-url-malware",SUSPICIOUS_PAGE:"suspiciousPage",SUSPICIOUS_TLD:"suspiciousTLD",RISKY_PATTERN:"riskyPattern",SUSPICIOUS_CONTENT:"suspiciousContent",MALWARE_PATTERN:"malware-pattern",ALERT_LOOP:"alertLoop",AUTH_REQUIRED_LOOP:"authRequiredLoop",CREATE_URL_LOOP:"createURLLoop",EXTENSION_INSTALL:"extensionInstall",FULL_SCREEN_LOOP:"fullScreenLoop",HISTORY_LOOP:"historyLoop",NOTIFICATION_LOOP:"notificationLoop",PRINT_LOOP:"printLoop",ADWARE:"adware",REPUTATION:"reputation",TROJAN:"trojan",MALVERTISING:"malvertising",WORM:"worm",RANSOMWARE:"ransomware",ROOTKIT:"rootkit",BACKDOOR:"backdoor",SPYWARE:"spyware",ALLOWED_EXCLUSION_VALUE:4}),SCAM:Object.freeze({type:"scam",TSS:"tss",SCAM_HEURISTIC:"scam_heuristic",ALLOWED_EXCLUSION_VALUE:6}),PHISHING:Object.freeze({type:"phishing",PHISHING_SUSPICIOUS_POST:"phishing_suspicious_post",PHISHING_BANKING:"phishing_banking",PHISHING_LOGIN:"phishing_login",PHISHING_LOGIN_VIA_TUNNEL:"phishing_login_via_tunnel",TELEMETRY_PHISHING_TUNNEL:"telemetryPhishingTunnel"}),AD:Object.freeze({type:"ad",ADSERVER:"adserver",ALLOWED_EXCLUSION_VALUE:2}),ADS:Object.freeze({type:"ads",ADSERVER:"adserver",ALLOWED_EXCLUSION_VALUE:2})}),Object.freeze({CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",EDGE:"Edge",SAFARI:"Safari"}),Object.freeze({origins:["<all_urls>"],permissions:[],optional_permissions:[]}),new RegExp(/^(.*?)(##|#\?#)(.+)$/),Object.freeze({Chrome:Object.freeze({origins:[],permissions:["alarms","downloads","storage","tabs","declarativeNetRequest","declarativeNetRequestFeedback","unlimitedStorage","webRequest","contextMenus","nativeMessaging","offscreen","activeTab","clipboardRead","clipboardWrite"]}),Firefox:Object.freeze({origins:[],permissions:["alarms","downloads","storage","tabs","declarativeNetRequest","declarativeNetRequestFeedback","unlimitedStorage","webRequest","webRequestBlocking","contextMenus","nativeMessaging","activeTab","clipboardRead","clipboardWrite"]}),Edge:Object.freeze({origins:[],permissions:["alarms","downloads","nativeMessaging","storage","tabs","webRequest","declarativeNetRequest","declarativeNetRequestFeedback","unlimitedStorage","contextMenus","offscreen","clipboardRead","clipboardWrite"]}),Safari:Object.freeze({origins:[],permissions:[]})}),Object.freeze({clipboardRead:{title:"clipboardReadPermTitle",description:"clipboardReadPermDesc"},clipboardWrite:{title:"clipboardWritePermTitle",description:"clipboardWritePermDesc"},alarms:{title:"alarms",description:"alarms"},downloads:{title:"downloads",description:"downloads"},storage:{title:"storage",description:"storage"},tabs:{title:"tabs",description:"tabs"},declarativeNetRequest:{title:"declarativeNetRequest",description:"declarativeNetRequest"},declarativeNetRequestFeedback:{title:"declarativeNetRequestFeedback",description:"declarativeNetRequestFeedback"},unlimitedStorage:{title:"unlimitedStorage",description:"unlimitedStorage"},webRequest:{title:"webRequest",description:"webRequest"},contextMenus:{title:"contextMenus",description:"contextMenus"},nativeMessaging:{title:"nativeMessaging",description:"nativeMessaging"},offscreen:{title:"offscreen",description:"offscreen"},activeTab:{title:"activeTab",description:"activeTab"}}),new Promise((e=>{window.addEventListener("message",(function t(i){i.source===window&&i.data&&"MSG_CHECK_DOMAIN_ALLOW_LIST_RESPONSE"===i.data.type&&(window.removeEventListener("message",t),e(i.data.isAllowListed))})),""!=window.location.hostname&&window.postMessage({type:"MSG_CHECK_DOMAIN_ALLOW_LIST",domainUrl:window.location.hostname,exclusionType:"EXCLUSION_SCAMS"},"*")})).then((t=>{t?console.log("TSS: Domain is in allow list, skipping TSS setup."):e("nonce",((e,t,i)=>{console.debug(`TSS: Checking if repeated ${i} times for interval ${t} against data: `,e);const o=Date.now();if(e.lastTime)if(o-e.lastTime<t){if(e.lastCount++,e.lastCount>=i)return!0}else e.lastTime=o,e.lastCount=1;else{if(1===i)return e.lastTime=o,e.lastCount=1,!0;e.lastTime=o,e.lastCount=1}return!1}),"injection-tss")}))})();
//# sourceMappingURL=injection-tss-mv3.js.map