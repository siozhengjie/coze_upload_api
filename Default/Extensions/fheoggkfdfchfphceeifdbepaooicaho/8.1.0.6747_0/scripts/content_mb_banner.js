/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2025 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="SEND_TELEMETRY",t="SHOW_MB_SIDEBAR",n="MB_VIDEO_FLAGGED",i="PING_CONTENT_MB_BANNER",s="MB_BANNER_SHOW",o="MB_BANNER_REMOVE",a="BROADCAST_MB_UPDATE_UI",r={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},l=(Object.values(r).reduce((e,t)=>e+t),{NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL",*[Symbol.iterator](){for(const e of Object.keys(this))yield e}}),{NONE:_,...c}=r,d={name:"BLOCK_PAGE_WHITELIST",type:"array"},p={name:"POPUP_STATS",type:"object"},E={name:"RAT_DETECTION_WHITELIST",type:"array"},m={name:"LAST_ANTITRACKER_SCAN_RESULT",type:"object"},u={name:"ANTITRACKER_UPSELL_TASK",type:"object"},g={name:"FINGER_PRINT",type:"number"},h={name:"FIRST_PARTY",type:"number"},T={name:"THIRD_PARTY",type:"number"},N={name:"TRACKER_DOMAIN_LIST",type:"array"},A={name:"ANTITRACKER_WHITELIST",type:"array"},y={name:"TYPOSQUATTING_WHITELIST",type:"array"},S={name:"CACHE_TAB_DATA",type:"object"},I=chrome,b={GREEN:0,YELLOW:1,RED:2,GREY:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"GREY"!==e&&(yield this[e])}},D=1,f=2,C=3,O=0,w=1,v=3,R=2,L="1.0.0.43",B=-1,P=0,M=1,k=2,F=3,U=70,x=31,K=16,V=1,H=(e,t)=>Array.from(Array(t+1).keys()).slice(e),W=I.runtime.getURL(""),G={fingerPrintDomains:g.name,firstParty:h.name,thirdPartyTrackers:T.name},$="snoozed",q="enabled",Y=0,z="PRINT_IN_BACKGROUND",j={NONE:0,INFO:1,ERROR:2,WARN:3,DEBUG:4,ALL_IN_BACKGROUND:99},X=1,Q=2,J=3,Z=4,ee={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},te={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};const ne=new class{constructor(){this.storageChecked=!1,this.logLevel=null,this.queue=[];const e="MCLOGLEVEL";chrome?.storage?.local.get([e]).then(t=>{const n=Object.values(j).includes(t[e]);this.logLevel=n?t[e]:Y,this.logLevel!==j.NONE&&this.queue.forEach(({callback:e,message:t,processType:n})=>{e(t,n)}),this.queue=[],this.storageChecked=!0})}log(e,t=null){this.storageChecked?this.processLog(e,X,t,this.logLevel):this.queue.push({callback:this.log.bind(this),message:e,processType:t})}error(e,t=null){this.storageChecked?this.processLog(e,Q,t,this.logLevel):this.queue.push({callback:this.error.bind(this),message:e,processType:t})}warn(e,t=null){this.storageChecked?this.processLog(e,J,t,this.logLevel):this.queue.push({callback:this.warn.bind(this),message:e,processType:t})}debug(e,t=null){this.storageChecked?this.processLog(e,Z,t,this.logLevel):this.queue.push({callback:this.debug.bind(this),message:e,processType:t})}processLog(e,t,n,i){if(i===j.NONE)return;let s="chrome-extension:"===location.protocol?ee.BACKGROUND:ee.CONTENT;n&&ee[n]&&(s=n);const o=this.formatDateWithMilliseconds(new Date),a=t===Q?e:`%c[${s} ${o} ]: %c${e}`;s===ee.CONTENT&&this.logLevel===j.ALL_IN_BACKGROUND&&chrome.runtime.sendMessage({command:z,logMessage:a,processType:s,logType:t,logLevel:i}),this.printLog(a,s,t,i)}formatDateWithMilliseconds(e){return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).format(e)}.${e.getMilliseconds().toString().padStart(3,"0")}`}printLog(e,t,n,i){const s=te.DEFAULT,o=te[t]||s;if(i>=j.ERROR&&n===Q&&console.error(e),i>=j.INFO&&n===X&&console.log(e,o,s),i>=j.WARN&&n===J){const t="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${e}`,t,o,s)}if(i>=j.DEBUG&&n===Z){const t="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${e}`,t,o,s)}}},ie=async(e,t,n,i)=>{try{chrome.tabs.sendMessage(i,{ipcId:e,command:t,...n},{},()=>{chrome.runtime.lastError})}catch(e){ne.warn(`[broadcast] Unexpected error when calling command: "${t}", err: ${e.message}`)}},se=(e,t,n,i,s=null)=>{if(!chrome.tabs)throw new Error('"tabs" permission not set in manifest.');const o={};return"number"==typeof s&&(o.frameId=s),chrome.tabs.sendMessage(i,{ipcId:e,command:t,...n},o)},oe=(e,t={},n)=>(async(e,t,n={},i={})=>{try{if(i?.tabId){const{tabId:s,frameId:o}=i;return await se(e,t,n,s,o)}if(i?.broadcast){const s=await chrome.tabs.query({}),{broadcastIgnoreId:o=[]}=i;return s.filter(({id:e})=>!o.includes(e)).forEach(({id:i})=>{ie(e,t,n,i)}),!0}return await chrome.runtime.sendMessage({ipcId:e,command:t,...n})}catch(e){return ne.warn(`Unexpected error when calling command: "${t}", err: ${e.message}`),null}})("WA",e,t,n);const ae=e=>{"undefined"!=typeof document&&null!==document&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?e():document.addEventListener("DOMContentLoaded",e))};const re=(e,t=null,n)=>{"function"==typeof n?chrome.runtime.onMessage.addListener((i,s,o)=>{if(s.id===chrome.runtime.id&&"object"==typeof i&&!Array.isArray(i)&&i?.ipcId===e)return n({promises:t,request:i,sender:s,sendResponse:o})}):ne.error("Provided with invalid callback function")};class le{constructor(e){this.pingCommand=e,this.basePingListener(),this.addIdentifier()}basePingListener(e=null){re("WA",null,({request:t,sendResponse:n})=>{const{command:i}=t;if(i===this.pingCommand)return ne.debug(`File Injection [pinged]: Received ${i} command`),n({content:!0}),"function"==typeof e&&e(),!0})}addIdentifier(){ae(()=>{const e=document.createElement("span");e.id=this.pingCommand,e.style.cssText="display:none",document.body.appendChild(e)})}}class _e{static geti18nRes(e,t=[]){let n=I.i18n.getMessage(e,t);const i=I.i18n.getMessage("res_PRODUCT_NAME_TRADEMARKED");return n=n.replace(/%PRODUCTNAME%/g,i),n}static getResStr(e,t){const n=_e.geti18nRes(e);t("??"===n?"":n)}static async getFileSource(e){try{return(await fetch(I.runtime.getURL(e))).text()}catch(e){return""}}}class ce{constructor(e=null,t=document){if(this.resourcerequestor=_e,this.document=t,e){const t=this.document.querySelectorAll(`#${e}`);t&&(this.document=t[0].contentDocument)}this.localeData=this.localeData.bind(this),this.fillText=this.fillText.bind(this),this.fillLocalizedTexts=this.fillLocalizedTexts.bind(this),this.fillInputPlaceHolders=this.fillInputPlaceHolders.bind(this)}localeData(e,t=[]){return this.resourcerequestor.geti18nRes(e,t)}fillText(e,t){const n=this.document.getElementById(e);if(n){const e=n.getAttribute("x-mcinsertposition");if(e)return void n.insertAdjacentText(e,t);n.textContent=t,n.setAttribute("x-mcl10nprocessed",!0)}}fillLocalizedTexts(){for(const{id:e}of this.document.querySelectorAll("*[x-mclocalizedtext]:not([x-mcl10nprocessed=true])")){const t=this.localeData(e);if(null==t)return!1;this.fillText(e,t)}return!0}fillInputPlaceHolders(){for(const{id:e}of this.document.querySelectorAll("*[x-inputplaceholder]")){const t=this.localeData(e),n=this.document.getElementById(e);if(null==t)return!1;null!=n&&n.setAttribute("placeholder",t)}return!0}init(){this.fillLocalizedTexts(),this.fillInputPlaceHolders()}}const de=e=>{let{top:t,left:n}=pe(e);return t<0&&(t=0),n<0&&(n=0),{top:t,left:n}},pe=e=>{const t=e.getBoundingClientRect(),n=window.pageYOffset||window.scrollY,i=window.pageXOffset||window.scrollX;return{top:Math.round(t.top+n),left:Math.round(t.left+i),bottom:Math.round(t.bottom+n),right:Math.round(t.right+i)}},Ee="NO_VIDEO_PLAYING",me="NO_AUDIO_PLAYING",ue="FEATURE_OFF",ge="DISPLAYED";const he="unknown",Te={EVENT_NAME:"wa_deepfake_detection",EVENT_ID:"wa_deepfake_detection"},Ne={EVENT_NAME:"wa_main_extension_update_status",EVENT_ID:"wa_main_extension_update_status"},Ae="screen",ye="event",Se="ai_audio_detected",Ie="ai_audio_not_detected",be="no_suite",De="unable_read_csp_id",fe="impression",Ce="accepted",Oe="faq_request",we="closed",ve="fades_away",Re="expand",Le="snoozed",Be="back_to_entry",Pe="support_request",Me="back_to_deepfake_side_panel",ke="auto_accepted",Fe={ACTIVATION_ENROLLMENT_BANNER:"wa_deepfake_activation_enrollment_banner",AI_ANNOTATION_BANNER:"wa_deepfake_banner_annotation",SIDEBAR_PANEL:"wa_deepfake_side_panel",SIDEBAR_FAQ_PANEL:"wa_deepfake_faq"},Ue={EMBEDED_BANNER:"embedded",PAGE_BANNER:"page",AI_ANNO_FULL_BANNER:"banner_only",AI_ANNO_HOVER_BANNER:"icon_and_banner_on_hover",AI_ANNO_ICON_BANNER:"icon_only"},xe={AUDIO_PLAYING:"audio_playing",X_CLICKED:"x_clicked",AUTO_ACTIVATE_TRIGGERED:"auto_activation_triggered",ACTIVATION_LEARM_MORE_CLICKED:"learn_more_clicked",ACTIVATION_ACCEPT:"deepfake_activation_accepted",ANNO_BANNER_CLICKED:"banner_clicked",ANNO_BANNER_FADE_AWAY:"time_elapsed",ANNO_BANNER_HOVER:"banner_hover",ANNO_BANNER_CLICKED_FOR_SIDEBAR:"deepfake_banner_annotation_clicked",MAIN_SIDEBAR_DFD_CLICKED:"sidebar_panel_deepfake_icon_clicked",FAQ_PANEL_BACK_CLICKED:"back_from_faq_clicked",SNOOZE_OPTION_SELECTED:"snooze_option_selected",AUDIO_DETECTION_TOGGLE_BTN_CLICKED:"audio_detection_toggle_switched",DFD_PANEL_BACK_CLICKED:"back_button_clicked",DFD_PANEL_BASICS_BTN_CLICKED:"deepfake_basics_button_clicked",DFD_PANEL_BUY_BTN_CLICK:"buy_now_button_clicked",DFD_PANEL_ON_TRIAL_BUY_BTN_CLICK:"buy_now_on_trial_clicked",DFD_FAQ_PANEL_SUPPORT_BTN_CLICKED:"contact_support_link_clicked",DFD_FAQ_PANEL_BACK_CLICKED:"back_button_clicked",DFD_FEEDBACK_THUMB_UP:"feedback_thumb_up",DFD_FEEDBACK_THUMB_DOWN:"feedback_thumb_down",DFD_FEEDBACK_SUBMIT:"feedback_submit"},Ke={NO_ACTION:"no_action",WA_INTERACTION:"wa_interaction"},Ve={GENERIC_ERR:"generic_error",NO_AUDIO_PLAYING:"no_audio_playing",NO_VIDEO_PLAYING:"no_video_playing",DETECTION_OFF:"detection_off",NOTIFICATION_PAUSE:"notification_paused",GRAPH_DISPLAYED:"graph_displayed"};class He{static toTlmWpsCspClientId(e){let t=e;return null===t?t=be:void 0===t&&(t=De),t}static toTlmAudioGraphStatus(e,t){let n=Ve.NOTIFICATION_PAUSE;if(t)return n;if(n=Ve.GENERIC_ERR,!e)return n;switch(e){case Ee:n=Ve.NO_VIDEO_PLAYING;break;case me:n=Ve.NO_AUDIO_PLAYING;break;case ue:n=Ve.DETECTION_OFF;break;case ge:n=Ve.GRAPH_DISPLAYED}return n}static toTlmActivatedDays(e){let t=he;if(e<=0)return t;const n=Date.now()-e;return t=Math.ceil(n/864e5),t}}const We="whitelist",Ge="preference",$e="statistics",qe="about",Ye="Block_Page",ze="BrowserAction_Clicked",je="Browser_Navigate",Xe="DarkWebMonitoring",Qe="ProfileInfo",Je="RemoteAccessTrojan",Ze="Secure_Search_Hit",et="SideBar_Panel",tt="wa_site_report_impression",nt="SMA_Reputation",it="Typosquatting",st="WSS_Analytics",ot={EVENT_NAME:"AdvancedProtectionSignals",IMPRESSION_BALLOON:"IMPRESSION_BALLOON",IMPRESSION_HOVER:"IMPRESSION_HOVER",CLOSE_BALLOON:"CLOSE_BALLOON",TOAST_CLOSE:"TOAST_CLOSE",TOAST:"toast",BALLOON:"balloon"},at="BrowserActionClicked",rt="Typosquatting",lt="BlockPage",_t="SecureSearchHit",ct="SideBarPanel",dt="SMAReputation",pt="Impression",Et="WebAdvisor",mt={MAIN:"Main"},ut="CloseClicked",gt={ACKNOWLEDGED:"Acknowledged",WHITELISTED:"Whitelisted"},ht="Close",Tt="GotIt",Nt="Hover",At="About",yt="Preferences",St="Whitelist",It="UserStatistics",bt="Green",Dt="Yellow",ft="Red",Ct="Grey",Ot="UNKNOWN",wt="Typosquatting",vt="Phishing",Rt="DefaultSearch",Lt={CLICK:"click",KEYDOWN:"keydown",RETURN_KEY_CODE:13,SHOW:"show",SEARCH_SUGGEST_KEY_CODES:[8,32,46,...H(48,57),...H(65,90),...H(96,107),...H(109,111),...H(186,192),...H(219,222)]},Bt={LOADED:"Loaded",CHECKED:"checked",UNKNOWN:"UNKNOWN",ACTION_PANEL:"ActionPanel",ACCEPTED:"Accepted",DECLINED:"Declined",SETTINGS_TAB_PREFIX:"settings_tab_",GREEN:"GREEN",YELLOW:"YELLOW",RED:"RED",PREFERENCE:"Preference",DEFAULT:"default"};class Pt{static toTelemetryBlockState(e){let t=Ot;switch(e){case b.GREEN:t=bt;break;case b.YELLOW:t=Dt;break;case b.RED:t=ft;break;case b.GREY:t=Ct;break;case b.TYPOSQUATTING:t=wt;break;case b.PHISHING:t=vt}return t}static toTelemetrySettingTab(e){let t=yt;switch(e){case We:t=St;break;case $e:t=It;break;case qe:t=At}return t}}class Mt{static PreprocessSecureSearchRegEx(e){return e.trim().split("\n")}static getBrowserSuffix(){const{CH:e,FF:t,EDGE:n}={CH:"_ch",FF:"_ff",IE:"_ie",EDGE:"_ed"},i={};return i[C]=n,i[D]=t,i[f]=e,i[R]}}const{SYSTEM:kt,USER:Ft}={SYSTEM:0,USER:1},Ut=Mt.getBrowserSuffix(),xt={DEV_MODE:{scope:kt,name:"dev_mode",value:!1},AFF_ID:{scope:kt,name:"*Affid",value:0},BINARY_VERSION:{scope:kt,name:"version",value:null},EXTENSION_VERSION_CH:{scope:kt,name:"ChromeExtVersion",value:"",writeOnly:!0},EXTENSION_VERSION_FF:{scope:kt,name:"*FirefoxXPIVersion",value:"",writeOnly:!0},EXTENSION_VERSION_ED:{scope:kt,name:"EdgeExtVersion",value:"",writeOnly:!0},BROWSER_TYPE:{scope:kt,name:"browsertype",value:"",writeOnly:!0},USER_AGENT:{scope:kt,name:"useragent",value:"",writeOnly:!0},SUGGESTION_URL:{scope:kt,name:"suggestion_url",value:""},SCRIPT_GENERATED_DEFAULT_SS_URL:{scope:Ft,name:`SCRIPT_GENERATED_DEFAULT_SS_URL${Ut}`,value:""},SECURE_SEARCH_REGEXES:{scope:Ft,name:"SECURE_SEARCH_REGEXES",value:"",preprocess:Mt.PreprocessSecureSearchRegEx},SHOW_SEARCH_SETTINGS:{scope:kt,name:"*ShowSearchSettings",value:!0},SECURE_SEARCH_TOAST_STAMP:{scope:Ft,name:`*SSDateStampShowedToast${Ut}`,value:0},SECURE_SEARCH_ANNOTATION_ONLY:{scope:kt,name:"*OnlyShowAnnotationsOnSecureSearch",value:!0},SECURE_SEARCH_SHOW_ICONS:{scope:Ft,name:"*Icons",value:!0},SECURE_SEARCH_CHOICE:{scope:Ft,name:`*SSToastChoice${Ut}`,value:!1},SS_DEF:{scope:kt,name:`*SS_DEF${Ut}`,value:0},ANNOTATIONS_CHOICE_EXPLICIT:{scope:kt,name:`*AnnotationsChoiceExplicit${Ut}`,value:!1},CURRENT_SAO_IN_EXTENSION:{scope:Ft,name:`*CurrentSAOInExtension${Ut}`,value:""},FF_EXTENSION_LAST_TOAST_TIME:{scope:Ft,name:"ff_extension_last_toast_time",value:0,writeOnly:!0},FF_EXTENSION_TOAST_COUNT:{scope:Ft,name:"ff_extension_toast_count",value:0,writeOnly:!0},CHECKLIST_START_INGORE_DATE_AV:{scope:kt,name:"startIgnoreDateAV",value:"",writeOnly:!0},CHECKLIST_START_IGNORE_DATE_FW:{scope:kt,name:"startIgnoreDateFW",value:"",writeOnly:!0},CHECKLIST_IGNORE_DURACTION:{scope:kt,name:"ignoreDuration",value:"14",writeOnly:!0},CHECKLIST_GRACE_PERIOD_AV:{scope:kt,name:"fixGracePeriodStartDateAV",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_FW:{scope:kt,name:"fixGracePeriodStartDateFW",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_DURATION:{scope:kt,name:"fixGracePeriodDuration",value:"24",writeOnly:!0},CRYPTOJACKING_DISABLED:{scope:kt,name:"CryptojackingDisabled",value:!0},SMA_USER_TOGGLE:{scope:kt,name:`sma_user_toggle${Ut}`,value:!1,writeOnly:!0},SMA_ANNOTATION_OPTIONS:{scope:kt,name:`sma_annotation_options${Ut}`,value:0,writeOnly:!0},PAGES_SCANNED:{scope:kt,name:"*CounterPagesScanned",value:0},PAGES_BLOCKED:{scope:kt,name:"*CounterPagesBlocked",value:0},DOWNLOADS_SCANNED:{scope:kt,name:"*CounterDownloadsScanned",value:0},DOWNLOADS_BLOCKED:{scope:kt,name:"*CounterDownloadsBlocked",value:0},BLOCKPAGE_WHITELIST:{scope:Ft,name:"*WhiteList",value:""},TS_WHITELIST:{scope:Ft,name:"*TListWhiteList",value:""},CSP_ID_SETTING:{scope:kt,name:"CSPIdValue",value:"__not_available__"},MTI_CLIENT_ID:{scope:kt,name:"gti_client_id",value:""},JWT_TOKEN_ENABLED:{scope:kt,name:"jwt_token_enabled",value:!1},UNINSTALL_SURVEY_ENABLED:{scope:kt,name:"uninstall_survey_enabled",value:!1},UNINSTALL_SURVEY_URL:{scope:kt,name:"uninstall_survey_url",value:""},RAT_DETECTION_ENABLED:{scope:kt,name:"rat_detection_enabled",value:!0},IDPS_FEATURE_ENABLED:{scope:kt,name:"idps_feature_enabled",value:0},APS_COHORT:{scope:kt,name:"aps_cohort",value:0},APS_TOGGLE_SETTING:{scope:kt,name:"aps_toggle_setting",value:!0},APS_SHOPPING_COHORT:{scope:kt,name:"aps_shopping_cohort",value:0},ALT_TRIGGER:{scope:kt,name:"alt_triggers_cohort",value:0},ANNOTATION_JOURNEY_COHORT:{scope:kt,name:`annotation_journey_cohort${Ut}`,value:0},ANNOTATION_JOURNEY_TOAST:{scope:Ft,name:`aj_toast${Ut}`,value:null},DAILY_GREEN_URLS_TO_COLLECT:{scope:kt,name:"daily_green_urls_to_collect",value:0},FEATURE_COLLECTION_ENABLED:{scope:kt,name:"feature_collection_enabled",value:!1},DAILY_GREEN_URLS_RESET_RATE:{scope:kt,name:"daily_green_urls_reset_rate",value:0},HERON_REPORT_ENABLED:{scope:kt,name:"heron_report_enabled",value:!1},SAMPLING_RATE_BLOCK_DEFAULT:{scope:kt,name:"sampling_rate_block_default",value:100},SAMPLING_RATE_USER_FEEDBACK:{scope:kt,name:"sampling_rate_user_feedback",value:1},WA_EXTN_UUID:{scope:Ft,name:`wa_extn_uuid${Ut}`,value:"",writeOnly:!0},TYPOSQUAT_ENABLED:{scope:kt,name:"typosquat_enabled",value:!0},MOCKINGBIRD_ENABLED:{scope:kt,name:"mockingbird_enabled",value:!0},DFD_FEEDBACK_ENABLED:{scope:kt,name:"dfd_feedback_enabled",value:!1},DFD_ENTITLED:{scope:kt,name:"dfd_entitled",value:null,writeOnly:!0},DFD_ACTIVATED:{scope:kt,name:"dfd_activated",value:null,writeOnly:!0},DFD_SHOW_ACTIVATE_BANNER:{scope:kt,name:"dfd_show_activate_banner",value:!1},NATIVE_DEVICE_ID:{scope:kt,name:"context_device_id",value:"unknown"}};class Kt{static getResetValues(){return{blockedIframes:[],tabDomainTrusted:!1,mockingbird:{},mbVideoId:null}}static getDefaultValues(){return Kt.getResetValues()}reset(e){const t=nn.localStore.get(S.name,{}),n=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;nn.htiReportHandler.checkBacklog(e,t[e],n),this.update(e,Kt.getResetValues())}get(e){return nn.localStore.get(S.name,{})[e]||Kt.getDefaultValues()}set(e,t){const n=nn.localStore.get(S.name,{});n[e]=t,nn.localStore.set(S.name,n)}delete(e){const t=nn.localStore.get(S.name,{}),n=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;nn.htiReportHandler.checkBacklog(e,t[e],n),delete t[e],nn.localStore.set(S.name,t)}update(e,t){const n=this.get(e);this.set(e,{...n,...t})}setTabBlockPageData(e,t,n=!0){const i={...this.get(e),blockPageData:t};this.set(e,i),n&&!t.url.includes("chrome://extensions/")&&nn.htiReportHandler.addReportToBacklog(e,i)}addBlockedFrame(e,t){const n=this.get(e);n.blockedIframes.push(t),this.update(e,n),nn.htiReportHandler.addIFrameReportToBacklog(e,n)}getBlockedFrames(e){return this.get(e).blockedIframes}resetBlockedFrames(e){const t=this.get(e);t.blockedIframes=[],this.update(e,t)}}const Vt="ph",Ht="www.siteadvisor.com/",Wt="https://mip.api.mcafeewebadvisor.com/v1/typosquatting?",Gt="https://sadownload.mcafee.com/products/SA/Win/extensions/engines/update.json",$t="https://sadownload.mcafee.com/products/SA/Win/extensions/sailor/condition.json",qt="https://sadownload.mcafee.com/products/SA/Win/extensions/antitracker/all_trackers.json",Yt="https://threat.api.mcafee.com/",zt="https://sadownload.mcafee.com/products/SA/Win/extensions/waextension/condition.json",jt="https://sadownload.mcafee.com/products/SA/Win/extensions/waextension/featureflag",Xt=new Set(["www.mcafee.com"]),Qt="PAGES_SCANNED",Jt="PAGES_BLOCKED",Zt="DOWNLOADS_SCANNED",en="DOWNLOADS_BLOCKED";class tn{static init(){const e=this.read(),{PAGES_SCANNED:t,PAGES_BLOCKED:n,DOWNLOADS_SCANNED:i,DOWNLOADS_BLOCKED:s}=nn.nativeSettings,o={pagesScanned:t.value||e.pagesScanned,pagesBlocked:n.value||e.pagesBlocked,downloadsScanned:i.value||e.downloadsScanned,downloadsBlocked:s.value||e.downloadsBlocked};nn.localStore.set(p.name,o)}static add(e){const t=this.read();switch(e){case Qt:t.pagesScanned++;break;case Jt:t.pagesBlocked++;break;case Zt:t.downloadsScanned++;break;case en:t.downloadsBlocked++;break;default:return}nn.localStore.set(p.name,t)}static read(){const e={pagesScanned:0,pagesBlocked:0,downloadsScanned:0,downloadsBlocked:0},t=nn.localStore.get(p.name);return t&&Object.assign(e,t),e}}const nn={isTrustCheckRequired:!0,ExtensionTelemetryUrl:null,scheduleManager:null,isNativeConnected:!0,telemetryEngine:null,postInstallationPage:"https://www.mcafee.com/consumer/v/wa-how.html",listenerManager:null,firefoxInternalUUID:"",shadowMode:"closed",browserType:R,sessionStore:null,localStore:null,idb:null,ffViewports:null,garbageCollector:null,typoCache:null,logger:null,loglevel:null,messageDispatcher:null,port:null,tabData:new Kt,useNativeLogger:!1,wasm:null,userAgentInBase64:null,typoSquattingServer:Wt,tldParser:null,urlParser:null,trustedDomains:Xt,nativeSettings:xt,searchSuggest:null,ratBlacklist:[{domain:"www.beamyourscreen.com",urls:[]},{domain:"www.connectwise.com",urls:["www.connectwise.com/platform/unified-management/control"]},{domain:"get.gotoassist.com",urls:[]},{domain:"fastsupport.gotoassist.com",urls:[]},{domain:"www.join.me",urls:[]},{domain:"www.mikogo.com",urls:[]},{domain:"www.mikogo.de",urls:[]},{domain:"www.securelink.com",urls:[]},{domain:"join.zoho.com",urls:[]}],preconditions:null,platform:class{static debounce(e,t,n){let i;return(...s)=>{const o=n&&!i;clearTimeout(i),i=setTimeout(()=>{i=null,n||e(...s)},t),o&&e(...s)}}static isBrowserEN(){return I.i18n.getUILanguage().toLowerCase().startsWith("en")}static isChromeBrowser(){const e=navigator.userAgent.toLowerCase();return!(!e.includes("chrome")||!1==!!chrome)&&(!e.includes("opr")&&!e.includes("edg"))}static isWindowsOS(){const{platform:e}=navigator;return e&&-1!==e.search("Win")}static getPlatform(){const{platform:e}=navigator;let t=O;return-1!==e.search("Mac")?t=w:-1!==e.search("iPhone")&&(t=v),t}}.getPlatform(),launchPageOnInstall:!1,nativeDispatcher:null,wssNativeDispatcher:null,wssMessageDispatcher:null,wssNativeClient:null,WSS_INSTALLED:!1,isWPSInstalled:!1,searchEngines:null,enginesVersionUrl:Gt,engineCheckInterval:864e5,ENGINES_VERSION:L,AUTO_PLAY_NOTIFICATION_ENABLED:!1,DLS_POPUP_FOR_WA_NATIVE_ENABLED:!1,WA_EXTN_CONDITION_URL:zt,ALLOW_LOCALHOST:!1,IDPS_AUTH_URL:"https://csptoken.ccs.mcafee.com/auth/token",IDPS_BREACH_COUNT_URL:"https://identity.unifiedapis.mcafee.com/breach/v1/BreachCount",IDPS_CSP_CLIENT_ID:null,IDPS_IS_ENTITLED:!1,IDPS_PROVISION_ID:null,IDPS_LOGIN_DOMAIN:"https://protection.mcafee.com",UA_CLIENT:null,TYPOSQUATTING_MAX_CACHE:100,TYPOSQUATTING_EXPIRY:2592e6,typosquattingHandler:null,URL_DOWNLOAD_MAX_CACHE:100,URL_DOWNLOAD_EXPIRY:2592e6,WA_IMAGE_SECRET:null,apsUrlList:{shopping:{"www.amazon.com":{paths:["gp/cart"]}},email:{"mail.google.com/mail":{selector:"div[role=main] a"},"outlook.live.com/mail":{selector:"div[role=main][aria-label] a"},"outlook.office.com/mail":{selector:"div[role=main][aria-label] a"},"outlook.office365.com/mail":{selector:"div[role=main][aria-label] a"},"mail.yahoo.com":{selector:"div[role=main] ul li a"}}},apsAnimationTimeout:5e3,wpsRequestedSettings:["SMA_USER_TOGGLE","SEARCH_ANNOTATION_OPTION","SMA_ANNOTATION_OPTIONS"],permittedContentTypes:["application/vnd.microsoft.portable-executable","application/octet-stream","application/x-msdos-program","application/x-msdownload","binary/octet-stream","application/x-msdownload"],SUPPORTED_WEBSITE_LIST:["protection.mcafee.com","protection-dev-roadhouse-int.dvqa.mcafee.com","protection-dev2-roadhouse-int.dvqa.mcafee.com","protection-qa-roadhouse-int.dvqa.mcafee.com","protection-stg-roadhouse-pub.dvqa.mcafee.com","protection-stg2-roadhouse-pub.dvqa.mcafee.com","protection-stg3-roadhouse-pub.dvqa.mcafee.com"],mtiRequestor:null,htiServer:Yt,cspClientId:"e87c73de-b45e-4427-b590-5124401795b6",sailer:null,sailorConditionUrl:$t,allTrackerUrl:qt,antitrackData:new class{init(){nn.wssMessageDispatcher?.nativeDispatcher?.getATUpsellFlag(e=>{e?.antitrack_upsell_config?.enabled&&nn.scheduleManager.setEnabled(u.name,!0)})}isActive(){return!nn.isAntitrackerExtInstalled}isWhiteListed(e,t){return nn.localStore.get(A.name,["mcafee.com"]).some(t=>e.includes(t))||t.includes("fi")}addCountTo(e,t=1){const n=nn.localStore.get(e,0);nn.localStore.set(e,n+t)}getAndResetCount(e){const t=nn.localStore.get(e,0);return nn.localStore.set(e,0),t}addLatestDomain(e,t){try{this.addCountTo(t);const n=new Date,i=`${n.getFullYear()}${n.getMonth()}${n.getDate()}`,s=new URL(e).hostname.replace("www.",""),o=this.getDomainList();o.dataDate!==i&&(o.dataDate=i,o.domainHistoryMap={}),o.lastVisited=s,o.domainHistoryMap=o.domainHistoryMap||{},(o.domainHistoryMap[s]||Object.keys(o.domainHistoryMap).length<50)&&(o.domainHistoryMap[s]=(o.domainHistoryMap[s]||0)+1),nn.localStore.set(N.name,o)}catch(e){ne.log(`[AntitrackerData] Error adding last domain: ${e.message||e}`)}}getDomainList(){const e=nn.localStore.get(N.name,{});return JSON.parse(JSON.stringify(e))}updateWPS(e){try{e=e?JSON.parse(e):{};const{pagesBlocked:t=0,pagesScanned:n=0}=tn.read();let i=0;Object.values(G).forEach(t=>{const n=t.toLowerCase(),s=(e[n]||0)+this.getAndResetCount(t);e[n]=s,i+=s}),e.total_trackers=i,e.blocked_pages=t,e.scanned_pages=n,e.last_visited="",e.domain_history="",0===e.total_trackers&&0===e.blocked_pages&&0===e.scanned_pages&&""===e.last_visited&&""===e.domain_history||!this.isSameAsLastScan(e)&&nn.wssMessageDispatcher&&(nn.wssMessageDispatcher.nativeDispatcher.updateAntitrackerToWPS(e),nn.localStore.set(m.name,e))}catch(e){ne.log(`[AntitrackerData] Error sending AT updates to WPS: ${e.message}`)}}getDomainHistory(e={}){let t="";const n=Object.keys(e);if(0===n.length)return t;n.sort((t,n)=>e[n]-e[t]);for(let i=0;i<n.length&&i<5&&n[i];i++){const s=n[i];t+=`${s},${e[s]},`}return t.slice(0,-1)}isSameAsLastScan(e){const t=nn.localStore.get(m.name,{}),n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}},isAntitrackerExtInstalled:!1,sendDataToWpsFlag:!1,extnRequestUpdateThrottle:0,extnUpdateFrequency:144e5,extnUpdateTelemetrySample:0,extnUpdateTelemetryEnabled:!1,extnUpdateTelemetryHarvestFoldback:!1,analyticsContentVersion:"1.0.1",htiReportHandler:null,mockingBirdHandler:null,featureFlagManager:null,featureFlagServer:jt,featureFlagIsFreshInstalled:!1,dfdActiveTabRecording:!1,dfdRecordingTimer:-1},sn=(d.name,y.name,d.name,E.name,"ADD"),on="REMOVE",an={ANNOTATION:{},BackgroundIPC:null,BackgroundCommons:null,ContextTelemetry:null,TelemetryEventNames:null,UrlParser:null,Utils:null,Commands:{},CommonConstants:{},extension:null,SearchEngineHelper:null,prevLink:null,Logger:null};class rn{static getResString(e,t){an.ANNOTATION.resourceRequestor.getResStr(e,n=>{n?t(n):an.Logger.error(`Resource string ${e} failed to fetch through resource requestor`)})}}class ln{static async toHTICategoriesString(e,t=!1){const n=e=>new Promise(t=>{rn.getResString(e,e=>t(e))}),i=async(e,t)=>{const i={},s=await n(`category_id_${e}_name`);if(i.name=s,t){const t=await n(`category_id_${e}_description`);i.description=t}return i},s=[];for(const n of e)s.push(i(n,t));return await Promise.all(s)}static browserTypeToString(e=!1){let t="";switch(R){case 1:t="FF";break;case 2:t="CH";break;case 3:t="ED";break;case 4:t="SF";break;default:t="UN"}return e?t.toLowerCase():t}static toAnnotationImageClass(e){let t="";switch(ln.toColor(e)){case P:t="green";break;case k:t="red";break;case M:t="yellow";break;case F:t="grey"}return t}static isPhishingURI(e){return e&&e.includes(Vt)}static toBlockState(e){const t=ln.toColor(e);return t===M&&ln.isPhishingURI(e.category)?b.PHISHING:isNaN(t)?b.GREY:t}static toColor(e){let t=B;return e&&void 0!==e.trust?(t=e.trust>=U?P:e.trust>=x?F:e.trust>=K?M:e.trust>=V?k:B,t):t}static toSiteReportUrl(e){return`${I.runtime.getURL("html/site_status_site_report.html")}?url=${escape(e)}`}static isExtensionUrl(e){return e.startsWith(W)}static isAnyExtensionUrl(e){return e.startsWith(`${W.split("://")[0]}://`)}static isSafeUrl(e){return ln.isSiteAdvisorUrl(e)||ln.isExtensionUrl(e)}static isSiteAdvisorUrl(e){return e.startsWith(`http://${Ht}`)||e.startsWith(`https://${Ht}`)}static isPropertRedirectUrl(e){return ln.isPropertyWebURL(e)||e.startsWith("edge://")||e.startsWith("chrome://")}static isProperWebURL(e=""){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return t="0"===t.substring(2,3)?t.substring(0,1):t,`${t}k+`}return`${e}`}static hasEpochTimeElapsed(e,t){return(new Date).getTime()/1e3>e+t}static isPersonalPolicyEnabled(){return!0}static isActivityPolicyEnabled(){return!0}static async blockRequest(e,t,n){const i=await I.declarativeNetRequest.getDynamicRules();0===i.filter(e=>e.condition.urlFilter===t).length&&ln.addDynamicRule(e,t,n,i.length+1,0)}static async addDynamicRule(e,t,n,i,s){if(s>=10)ne.error(`Unable to add dynamic rule for tabId:${e}, on url: ${t}. message: ${n}`);else try{await I.declarativeNetRequest.updateDynamicRules({addRules:[{id:i,condition:{urlFilter:t,resourceTypes:["main_frame"]},action:{type:"block"}}]}),ne.log(`${n} ${t} ${e}`)}catch(o){ln.addDynamicRule(e,t,n,i+1,s+1)}}static async updateExcludedTabInSession(e,t){try{const n=999999,i=(await I.declarativeNetRequest.getSessionRules()).find(e=>e.id===n);let s=i?.condition?.tabIds||[],o=!1;const a=s.indexOf(e);t===sn&&-1===a?(s.push(e),o=!0):t===on&&-1!==a&&(s=s.filter(t=>t!==e),o=!0),o&&I.declarativeNetRequest.updateSessionRules({removeRuleIds:[n],addRules:[{id:n,condition:{tabIds:s},action:{type:"allow"}}]})}catch(e){ne.error(e.message)}}static updateHTIGlobalsAfterNativeConnection(){const e=nn.nativeSettings.MTI_CLIENT_ID.value,t=nn.nativeSettings.CSP_ID_SETTING.value,n=nn.nativeSettings.JWT_TOKEN_ENABLED.value;""!==e&&nn.mtiRequestor.setGlobals({clientIdGuid:e}),"__not_available__"!==t&&nn.mtiRequestor.setGlobals({cspid:t}),"boolean"==typeof n&&nn.mtiRequestor.setGlobals({jwtEnabled:n})}static newGuid(){const e=new Uint8Array(24);let t=Date.now().toString()+Math.random().toString().substring(2);for(let n=0;n<24;++n)t+=e[n].toString();let n="{";for(let e=0;e<36;++e)if(8===e||13===e||18===e||23===e)n+="-";else{n+=t[Math.floor(Math.random()*t.length)]}return n+="}",n}}class _n{constructor(e){this._options=e,this.TELEMETRY_HANDLERS=this.initializeTelemetryHandler()}fetchTelemetryHandlers(e){const t=[];return this.TELEMETRY_HANDLERS.forEach(n=>{n.trigger.identifier&&e!==n.trigger.identifier||t.push(n)}),t}initializeTelemetryHandler(){return[{trigger:{identifier:Ye,sendTelemetry:this._options.isFromBackground||!1},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,name:lt,interaction_type:pt,colour:Pt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:"UNKNOWN",_event_name:Ye,browser:ln.browserTypeToString()}}]},{trigger:{identifier:Ye,sendTelemetry:this._options.isFromForeground||!1},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,name:lt,interaction_type:this._options.interaction,colour:Pt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:"UNKNOWN",_event_name:Ye,browser:ln.browserTypeToString(),metadata:`url=${this._options.url}`}}]},{trigger:{identifier:Ye,selector:"#sidebar-close",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,name:lt,interaction_type:ut,colour:Pt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:"UNKNOWN",_event_name:Ye,browser:ln.browserTypeToString()}}]},{trigger:{identifier:ze,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:at,interaction_type:Et,badge_count:this._options.count,_event_name:ze,browser:ln.browserTypeToString()}}]},{trigger:{identifier:je,sendTelemetry:this._options.isFromBackground},messages:[{template:{analyticsSDK:!0,url:this._options.url,browser:ln.browserTypeToString(),_event_name:je}}]},{trigger:{identifier:Qe,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:pt,tab:Pt.toTelemetrySettingTab(Ge),_event_name:Qe,browser:ln.browserTypeToString()}}]},{trigger:{identifier:Qe,selector:`#${Bt.SETTINGS_TAB_PREFIX}${Ge}`,action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:pt,tab:Pt.toTelemetrySettingTab(Ge),_event_name:Qe,browser:ln.browserTypeToString()}}]},{trigger:{identifier:Qe,selector:`#${Bt.SETTINGS_TAB_PREFIX}${We}`,action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:pt,tab:Pt.toTelemetrySettingTab(We),_event_name:Qe,browser:ln.browserTypeToString()}}]},{trigger:{identifier:Qe,selector:`#${Bt.SETTINGS_TAB_PREFIX}${qe}`,action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:pt,tab:Pt.toTelemetrySettingTab(qe),_event_name:Qe,browser:ln.browserTypeToString()}}]},{trigger:{identifier:Qe,selector:`#${Bt.SETTINGS_TAB_PREFIX}${$e}`,action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:pt,tab:Pt.toTelemetrySettingTab($e),_event_name:Qe,browser:ln.browserTypeToString()}}]},{trigger:{identifier:Ze,sendTelemetry:!0},messages:[{template:{name:_t,search_type:Rt,_event_name:Ze,browser:ln.browserTypeToString(),type_tag:this._options.typeTag,provider_type:this._options.engineName}}]},{trigger:{identifier:et,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:ct,interaction_type:mt.MAIN,_event_name:et,browser:ln.browserTypeToString()}}]},{trigger:{identifier:tt,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:tt,block_state:Pt.toTelemetryBlockState(this._options.blockState),site_categories:this._options.siteCategories,url:this._options.displayUrl,_event_name:tt,browser:ln.browserTypeToString()}}]},{trigger:{identifier:nt,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:dt,interaction_type:pt,_event_name:nt,browser:ln.browserTypeToString(),site:this._options.site,color:Bt.GREEN,count:this._options[Bt.GREEN]}},{template:{analyticsSDK:!0,name:dt,interaction_type:pt,_event_name:nt,browser:ln.browserTypeToString(),site:this._options.site,color:Bt.RED,count:this._options[Bt.RED]}},{template:{analyticsSDK:!0,name:dt,interaction_type:pt,_event_name:nt,browser:ln.browserTypeToString(),site:this._options.site,color:Bt.YELLOW,count:this._options[Bt.YELLOW]}},{template:{analyticsSDK:!0,name:dt,interaction_type:pt,_event_name:nt,browser:ln.browserTypeToString(),site:this._options.site,color:Bt.UNKNOWN,count:this._options[Bt.UNKNOWN]}}]},{trigger:{identifier:it,sendTelemetry:this._options.isFromBackground},messages:[{template:{analyticsSDK:!0,name:rt,interaction_type:pt,browser:ln.browserTypeToString(),_event_name:it}}]},{trigger:{identifier:Je,state:Bt.LOADED,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:Je,interaction_type:pt,browser:ln.browserTypeToString(!0),url:this._options.url,_event_name:Je}}]},{trigger:{identifier:Je,selector:"#rat_detection_got_it_btn",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,name:Je,interaction_type:gt.ACKNOWLEDGED,browser:ln.browserTypeToString(!0),url:this._options.url,_event_name:Je}}]},{trigger:{identifier:Je,selector:"#sidebar_rat_detection_whitelist_btn",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,name:Je,interaction_type:gt.WHITELISTED,browser:ln.browserTypeToString(!0),url:this._options.url,_event_name:Je}}]},{trigger:{identifier:Je,selector:"#sidebar-close",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,name:Je,interaction_type:ut,browser:ln.browserTypeToString(!0),url:this._options.url,_event_name:Je}}]},{trigger:{identifier:st,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:st,message:this._options.message}}]},{trigger:{identifier:Xe,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:Xe,category:Xe,action_type:this._options.eventAction||Bt.UNKNOWN,browser:"un"===ln.browserTypeToString(!0)?Bt.UNKNOWN:ln.browserTypeToString(!0),count:this._options.count||Bt.UNKNOWN,type:this._options.type,flow_id:this._options.flowId}}]},{trigger:{identifier:ot.EVENT_NAME,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ot.EVENT_NAME,name:ot.EVENT_NAME,action_type:pt,browser:ln.browserTypeToString(!0),type:ot.TOAST,sequence:Bt.DEFAULT,trigger:Bt.DEFAULT,color:Bt.DEFAULT}}]},{trigger:{identifier:ot.IMPRESSION_BALLOON,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ot.EVENT_NAME,name:ot.EVENT_NAME,action_type:pt,browser:"un"===ln.browserTypeToString(!0)?Bt.UNKNOWN:ln.browserTypeToString(!0),type:ot.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color,navigated_page:this._options.navigatedPage}}]},{trigger:{identifier:ot.IMPRESSION_HOVER,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ot.EVENT_NAME,name:ot.EVENT_NAME,action_type:Nt,browser:"un"===ln.browserTypeToString(!0)?Bt.UNKNOWN:ln.browserTypeToString(!0),type:ot.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color,navigated_page:this._options.navigatedPage}}]},{trigger:{identifier:ot.CLOSE_BALLOON,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ot.EVENT_NAME,name:ot.EVENT_NAME,action_type:ht,browser:"un"===ln.browserTypeToString(!0)?Bt.UNKNOWN:ln.browserTypeToString(!0),type:ot.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color,navigated_page:this._options.navigatedPage}}]},{trigger:{identifier:ot.TOAST_CLOSE,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ot.EVENT_NAME,name:ot.EVENT_NAME,action_type:this._options.gotItButton?Tt:ht,browser:"un"===ln.browserTypeToString(!0)?Bt.UNKNOWN:ln.browserTypeToString(!0),type:ot.TOAST,sequence:Bt.DEFAULT,trigger:Bt.DEFAULT,color:Bt.DEFAULT}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:this._options.isFromActivationPage||!1},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:Ae,event_id:Te.EVENT_ID,screen_name:Fe.ACTIVATION_ENROLLMENT_BANNER,trigger:xe.AUDIO_PLAYING,action:Ke.NO_ACTION,is_interactive:!1,browser:ln.browserTypeToString(!0),interaction:fe,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:this._options.isFromAutoActivation||!1},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.ACTIVATION_ENROLLMENT_BANNER,trigger:xe.AUTO_ACTIVATE_TRIGGERED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:ke,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:"#mb_banner_learn_more",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.ACTIVATION_ENROLLMENT_BANNER,trigger:xe.ACTIVATION_LEARM_MORE_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Oe,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:"#banner_close_icon",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:this._options.screenName,trigger:xe.X_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:we,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"videoBannerShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:Ae,event_id:Te.EVENT_ID,screen_name:Fe.AI_ANNOTATION_BANNER,trigger:xe.AUDIO_PLAYING,action:Ke.NO_ACTION,is_interactive:!1,browser:ln.browserTypeToString(!0),interaction:fe,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:this._options.bannerNodeSelector||"",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.AI_ANNOTATION_BANNER,trigger:xe.ANNO_BANNER_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Ce,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:this._options.videoBannercloseBtn||"",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.AI_ANNOTATION_BANNER,trigger:xe.X_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:we,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"videoBannerHover"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:Ae,event_id:Te.EVENT_ID,screen_name:Fe.AI_ANNOTATION_BANNER,trigger:xe.ANNO_BANNER_HOVER,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Re,display_type:Ue.AI_ANNO_HOVER_BANNER,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"videoBannerFadeAway"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.AI_ANNOTATION_BANNER,trigger:xe.ANNO_BANNER_FADE_AWAY,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:ve,display_type:this._options.displayType,detection_status:Ie,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdSidebarShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:Ae,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_PANEL,trigger:this._options.initTriggerType,action:Ke.NO_ACTION,is_interactive:!1,browser:ln.browserTypeToString(!0),interaction:fe,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"snoozeOptionSelected"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.SNOOZE_OPTION_SELECTED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Le,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:this._options.buyNowBtn||"",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_PANEL,trigger:this._options.buyNowBtnClickedType,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Ce,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdPanelCloseClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.X_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:we,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdToggleBtnClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.AUDIO_DETECTION_TOGGLE_BTN_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:this._options.toggleType,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:this._options.backToEntryBtn||"",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.DFD_PANEL_BACK_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Be,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:this._options.mbBasicButton||"",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.DFD_PANEL_BASICS_BTN_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Oe,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdFaqSidebarShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:Ae,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_FAQ_PANEL,trigger:this._options.triggerForMbFaq,action:Ke.NO_ACTION,is_interactive:!1,browser:ln.browserTypeToString(!0),interaction:fe,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdFaqPanelCloseClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_FAQ_PANEL,trigger:xe.X_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:we,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:this._options.contactSupportLink||"",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_FAQ_PANEL,trigger:xe.DFD_FAQ_PANEL_SUPPORT_BTN_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Pe,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,selector:this._options.mbFaqBackBtn||"",action:Lt.CLICK},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,type:ye,event_id:Te.EVENT_ID,screen_name:Fe.SIDEBAR_FAQ_PANEL,trigger:xe.DFD_FAQ_PANEL_BACK_CLICKED,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:Me,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdFeedbackThumbUp"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,event_id:Te.EVENT_ID,type:ye,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.DFD_FEEDBACK_THUMB_UP,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:xe.DFD_FEEDBACK_THUMB_UP,detection_status:this._options.detection_status,top_level_domain:this._options.topLevelDomain||"unknown",is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdFeedbackThumbDown"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,event_id:Te.EVENT_ID,type:ye,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.DFD_FEEDBACK_THUMB_DOWN,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:xe.DFD_FEEDBACK_THUMB_DOWN,detection_status:this._options.detection_status,top_level_domain:this._options.topLevelDomain||"unknown",is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire}}]},{trigger:{identifier:Te.EVENT_NAME,sendTelemetry:"dfdFeedbackSubmit"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Te.EVENT_NAME,event_id:Te.EVENT_ID,type:ye,screen_name:Fe.SIDEBAR_PANEL,trigger:xe.DFD_FEEDBACK_SUBMIT,action:Ke.WA_INTERACTION,is_interactive:!0,browser:ln.browserTypeToString(!0),interaction:xe.DFD_FEEDBACK_SUBMIT,detection_status:this._options.detection_status,top_level_domain:this._options.topLevelDomain||"unknown",feedback_text_length:this._options.feedbackTextLength||0,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:this._options.isFromBackground||!1},messages:[{template:{analyticsSDK:!0,send_extension_only:!0,_event_name:Ne.EVENT_NAME,event_id:Ne.EVENT_ID,status:this._options.updateStatus,browser:ln.browserTypeToString(!0),freq:this._options.freq}}]}]}}class cn{static sendTelemetryMessages(t,n){const{sendTelemetry:i}=n.trigger,s=n.trigger.action,o=[Lt.CLICK],a=e=>{if(!e)return;const t=`${n.trigger.identifier}|${n.trigger.action}`;e.__waTlmKeys||Object.defineProperty(e,"__waTlmKeys",{value:new Set,enumerable:!1}),e.__waTlmKeys.has(t)||(e.addEventListener(n.trigger.action,r),e.__waTlmKeys.add(t))};function r(a){n.messages.forEach(n=>{const r={...n.template},l=i&&(void 0===r.count||0!==r.count);let _=o.includes(s);if(s===Lt.KEYDOWN&&t.whitelistedKeys){const e=a.keyCode;_=t.whitelistedKeys.includes(e)}(l||_)&&(t.isFromBackground?nn.messageDispatcher.sendTelemetry(JSON.stringify(r)):oe(e,{telemetry:JSON.stringify(r)}))})}n.trigger.selector&&n.trigger.action?t.containerMeta?a(t.containerMeta.query(n.trigger.selector)):ae(()=>{a(document.querySelector(n.trigger.selector))}):(i||n.trigger.state&&n.trigger.state===t.state)&&r()}static handle(e){new _n(e).fetchTelemetryHandlers(e.identifier).forEach(t=>{this.sendTelemetryMessages(e,t)})}}const dn="AI",pn="NO_AI",En="FULL_BANNER",mn="ON_HOVER",un="ICON_ONLY",gn="afterend",hn="afterbegin";class Tn{constructor(e,t,n,i){this.waImageSecret=n,this.wpsCspClientId=i,this.strConvertor=new ce,this.colors={white:"#FFFFFF",red:"#C01818",black:"#343434"},this.bannerData={[dn]:{bgc:this.colors.red,fontColor:this.colors.white,borderColor:"rgba(255, 255, 255, 0.4)",title:this.strConvertor.localeData("mb_video_banner_AI_audio_title"),closeBtn:`${chrome.runtime.getURL("images/banner/close_icon_white.svg")}?secret=${this.waImageSecret}`,icon:`${chrome.runtime.getURL("images/web_advisor/shield_white.svg")}?secret=${this.waImageSecret}`},[pn]:{bgc:this.colors.white,fontColor:this.colors.black,borderColor:"rgba(110, 110, 110, 0.4)",title:this.strConvertor.localeData("mb_video_banner_no_AI_audio_title"),closeBtn:`${chrome.runtime.getURL("images/banner/close_icon_black.svg")}?secret=${this.waImageSecret}`,icon:`${chrome.runtime.getURL("images/web_advisor/shield_red.svg")}?secret=${this.waImageSecret}`}},this.bannerId=e,this.videoElement=t,this.bannerNode=null,this.payload=null,this.timer=null,this.bannerType=null,this.topParentNode=null,this.isParentDefaultP=!1,this.srcUrl=null,this.bannerDetails=null,this.options={identifier:Te.EVENT_NAME,wpsCspClientId:He.toTlmWpsCspClientId(i)}}getBannerDetailsByVideoSize(){return this.videoElement.offsetWidth>=1081?(this.options.displayType=Ue.AI_ANNO_FULL_BANNER,{fontSize:22,lineHeight:37,bannerH:60,closeBtnH:30,aiIconSize:30,bannerAnimationType:En}):this.videoElement.offsetWidth>=721?(this.options.displayType=Ue.AI_ANNO_HOVER_BANNER,{fontSize:18,lineHeight:28,bannerH:46,closeBtnH:23,aiIconSize:23,bannerAnimationType:mn}):this.videoElement.offsetWidth>=481?(this.options.displayType=Ue.AI_ANNO_HOVER_BANNER,{fontSize:15,lineHeight:23,bannerH:38,closeBtnH:19,aiIconSize:19,bannerAnimationType:mn}):(this.options.displayType=Ue.AI_ANNO_ICON_BANNER,{fontSize:15,lineHeight:23,bannerH:38,closeBtnH:19,aiIconSize:19,bannerAnimationType:un})}init(e,t){this.payload=t,this.bannerType=e,this.bannerDetails=this.getBannerDetailsByVideoSize(),this.injectfont(),this.bannerNode=document.createElement("div"),this.bannerNode.setAttribute("id",`${this.bannerId}`),this.initBannerListeners(),this.setBannerElement(),this.appendBannerToVideoContainer(),window.addEventListener("resize",()=>{this.updateBannerPosition()},!1),window.addEventListener("scroll",()=>{this.updateBannerPosition()},!1);const{srcurl:n,topurl:i}=this.payload;this.srcUrl=n??i,this.options.originFrom="videoBannerShow",this.options.bannerNodeSelector=`#${this.bannerId}`,this.options.aiAnnoType=e===dn?Se:Ie,cn.handle(this.options)}injectfont(){try{const e=chrome.runtime.getURL("css/mcafee_fonts.css"),t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.head.appendChild(t)}catch(e){ne.error(e)}}setBannerElement(){const{fontSize:e,closeBtnH:t,bannerH:n,lineHeight:i,aiIconSize:s,bannerAnimationType:o}=this.bannerDetails,a=this.bannerType,r=`\n      position: absolute;\n      top: 10px;\n      left: 10px;\n      padding-right: ${o===En?"8px":"0px"};\n      border-radius: ${n}px;\n      margin: 10px;\n      z-index: 2147483647;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      font-family: McAfeePoppins, Arial !important;\n      opacity: 1;\n      box-shadow: 0 4px 4px 0 rgba(0, 0, 0, 0.2);\n      height: ${n}px;\n      width:  ${n}px;\n      background-color: ${this.bannerData[a].bgc};\n      gap: 3px;\n      overflow: hidden;\n      -webkit-transition: all 0.3s ease-in-out;\n      -moz-transition: all 0.3s ease-in-out;\n      transition: all 0.3s ease-in-out;\n      -webkit-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n    `;this.bannerNode.style=r;const l=`\n      height: ${s}px;\n      width: ${s}px;\n    `,_=`\n      display: flex;\n      color: ${this.bannerData[a].fontColor}; \n      line-height: ${i}px; \n      font-size: ${e}px; \n      font-weight: 600;\n      text-wrap: nowrap;\n    `,c=`\n      display: flex; \n      align-items: center; \n      border-left: 1px solid ${this.bannerData[a].borderColor};\n      margin: 0px 13px;\n      min-width: ${t}px;\n      min-height: ${t}px;\n    `,d=`\n      <div style='position: relative; height: ${n}px; width: ${n}px;'>\n        <div style='position: absolute; height: ${n}px; width: ${n}px; display: flex; justify-content: center; align-items: center'>\n          <img id='videoBannerIcon' src='${this.bannerData[a].icon}' style='${l}' />\n        </div>\n        <div style='height: ${n}px; width: ${n}px;'></div>\n      </div>\n    `,p=`\n      <div id="videoBannerContentContainer" style='display: flex; align-items: center; opacity: 0;'>\n        <div id='videoBannerTitle' style='${_}'>${this.bannerData[a].title}</div>\n        <div id='videoBannerCloseBtn' style='${c}'>\n          <img src='${this.bannerData[a].closeBtn}' style='padding-left:${e-8}px; height:${t}px;'/>\n        </div>\n      </div>\n    `,E=`${d}${un!==o?p:""}`;if(this.bannerNode.innerHTML=E,un!==o){const e=this.bannerNode.querySelector("#videoBannerCloseBtn");e?.addEventListener("click",e=>{this.options.closeBtnClicked=!0,e.stopPropagation(),this.hideBanner()}),e&&(this.options.videoBannercloseBtn="#videoBannerCloseBtn")}o===En&&setTimeout(()=>this.animateBanner(!0),250),this.bannerType===pn&&this.closeBannerOnTimeout(this.bannerType)}initBannerListeners(){this.bannerNode.addEventListener("click",e=>{e.stopPropagation(),oe(t,{mbVideoId:this.payload.id});const{bannerAnimationType:n}=this.bannerDetails;un===n&&this.hideBanner()}),this.bannerNode.addEventListener("mouseenter",({currentTarget:e})=>{this.options.displayType===Ue.AI_ANNO_HOVER_BANNER&&(this.options.originFrom="videoBannerHover",this.options.bannerNodeSelector="",this.options.videoBannercloseBtn="",cn.handle(this.options)),this.handleMouseEnterLeave("mouseenter",e)}),this.bannerNode.addEventListener("mouseleave",({currentTarget:e})=>{this.handleMouseEnterLeave("mouseleave",e)})}handleMouseEnterLeave(e){const{bannerAnimationType:t}=this.bannerDetails;t===mn&&this.animateBanner("mouseenter"===e),this.bannerType===pn&&("mouseenter"===e&&clearTimeout(this.timer),"mouseleave"===e&&this.closeBannerOnTimeout(this.bannerType))}animateBanner(e=!0){const{bannerH:t}=this.bannerDetails,n=this.bannerNode.querySelector("#videoBannerContentContainer");n&&(this.bannerNode.style.width=e?`${n.offsetWidth+t}px`:`${t}px`,this.bannerNode.style.paddingRight=e?"8px":"0px",n.style.opacity=e?1:0)}closeBannerOnTimeout(){this.timer=setTimeout(()=>{this.hideBanner(),this.options.aiAnnoType!==Ie||this.options.closeBtnClicked||(this.options.originFrom="videoBannerFadeAway",this.options.bannerNodeSelector="",this.options.videoBannercloseBtn="",cn.handle(this.options))},3e3)}hideBanner(){const{bannerAnimationType:e}=this.bannerDetails;un!==e&&this.animateBanner(!1),this.fadeOut(this.bannerNode,25,()=>{this.bannerNode.innerHTML="",this.bannerNode.style.display="none"})}updateBannerUI(e,t,n){this.srcUrl=t,this.payload=n,clearTimeout(this.timer),this.bannerType=e,this.setBannerElement(),this.updateBannerPosition()}appendBannerToVideoContainer(){this.topParentNode=(e=>{let t=e.parentElement;if(null===t)return e;let n=de(t);const i=de(e);let s=1,o=e;for(;null!==t&&i.top===n.top&&i.left===n.left&&s<3;)s++,o=t,t=t.parentElement,null!==t&&(n=de(t));return o})(this.videoElement),this.isParentDefaultP=["relative","fixed"].includes(window.getComputedStyle(this.topParentNode).getPropertyValue("position")),this.bannerNode.style.top=`${this.isParentDefaultP?10:this.topParentNode.offsetTop}px`,this.bannerNode.style.left=`${this.isParentDefaultP?10:this.topParentNode.offsetLeft}px`;const e="VIDEO"===this.topParentNode.tagName?gn:hn;this.topParentNode.insertAdjacentElement(e,this.bannerNode)}fadeIn(e,t,n){this.fadeInTimer=setInterval(()=>{e.style.opacity<1?e.style.opacity+=.2:(clearInterval(this.fadeInTimer),n())},t)}fadeOut(e,t,n){this.fadeOutTimer=setInterval(()=>{e.style.opacity>0?e.style.opacity-=.2:(clearInterval(this.fadeOutTimer),n())},t)}updateBannerPosition(){this.bannerNode.style.top=`${this.isParentDefaultP?10:this.topParentNode.offsetTop}px`,this.bannerNode.style.left=`${this.isParentDefaultP?10:this.topParentNode.offsetLeft}px`}closeBanner(){this.bannerNode.innerHTML="",this.bannerNode.style.display="none"}}class Nn{constructor(){this.banners={}}showBannerOnVideo(e,t){const{finalresult:n,srcurl:i,topurl:s,waImageSecret:o,wpsCspClientId:a,id:r}=t;if(0===e.offsetWidth||0===e.offsetHeight)return;const l=i??s;if(e.src&&e.src!==l)return void ne.log("[MB:showBannerOnVideo] video src changed, ignoring response from native to show banner.");const _=this.convertToBannerId(r),c=n?dn:pn,{videoBanner:d}=this.getBannerById(_);if(!d){const n=new Tn(_,e,o,a);return n.init(c,t),this.banners[_]={videoElement:e,videoBanner:n},void ne.log(`[MB:showBannerOnVideo] creating banner for bannerId=${_}, videoBanner.srcUrl=${n.srcUrl}`)}d.bannerType!==c?l===d.srcUrl&&c!==dn||(ne.log(`[MB:showBannerOnVideo] already exists, updating UI for bannerId=${_}, updatedUrl=${l}, videoBanner.srcUrl=${d.srcUrl}`),d.updateBannerUI(c,l,t),this.banners[_]={videoElement:e,videoBanner:d}):ne.debug("[MB:showBannerOnVideo] prevent same banner type from showing.")}getBannerById(e){for(const[t,{videoBanner:n}]of Object.entries(this.banners))if(e===t)return{videoBanner:n};return{}}removeBannerFromVideo(e){const t=this.convertToBannerId(e),{videoBanner:n}=this.getBannerById(t);n&&(delete this.banners[t],n.closeBanner())}convertToBannerId(e){return`m${e.replace(/[{} -]/g,"")}`}}(new class extends le{constructor(){super(i),this.bannerHandler=new Nn,this.enabled=null,this.status=null,this.waitingRoom=[],this.detectedFinalResult={}}async main(){this.messageListener()}messageListener(){re("WA",null,({request:e,sendResponse:t})=>{switch(e.command){case s:{const{payload:n}=e;return this.enabled=n.enabled,this.status=n.status,this.optinBannerId=n.optinBannerId,this.optinBannerId&&document.getElementById(this.optinBannerId)?(ne.debug("[MB:ContentMBBanner][waitroom] waiting on dfd activation banner to close."),this.waitingRoom.push(n),1===this.waitingRoom.length&&this.startWaitRoom()):this.showBanner(n),t({content:!0}),!0}case o:{const{payload:n}=e;return ne.debug("[MB:ContentMBBanner][listener] calling removeBanner."),this.removeBanner(n.id),t({content:!0}),!0}case a:{const{status:t,enabled:n}=e;return this.status=t,this.enabled=n,void(this.enabled&&this.status===q||(ne.debug("[MB:ContentMBBanner][listener] calling removeAllBanners."),this.removeAllBanners()))}}})}startWaitRoom(){this.timer=setInterval(()=>{if(!document.getElementById(this.optinBannerId)&&this.waitingRoom.length>0){const e=this.waitingRoom.filter(e=>1===e.finalresult),t=(e.length?e:this.waitingRoom).sort((e,t)=>t.currentime-e.currentime)[0];ne.debug("[MB:ContentMBBanner][waitroom] showing banner since dfd activation no longer present."),this.showBanner(t),this.waitingRoom=[]}0===this.waitingRoom.length&&clearInterval(this.timer)},1e3)}showBanner(e){try{const{id:t,srcurl:i,finalresult:s}=e,{element:o,capturing:a,permissionRequired:r}=window.audioMonitor.getById(t)||{};if(ne.log(`[MB:showBanner][${t}][${i}] Start - finalresult=${s}`),r)return;if(!this.detectedFinalResult[t]?.[i]&&s&&(ne.debug("[MB:showBanner] set dfdflagged=true"),(this.detectedFinalResult[t]??={})[i]=!0,oe(n,{payload:e})),!this.enabled||this.status!==q)return void ne.debug(`[MB:showBanner] returning early, enable=${this.enabled} or status=${this.status} (not enabled)`);this.detectedFinalResult[t]?.[i]&&(ne.debug("[MB:showBanner] dfdflagged exists. Force finalresult=1"),e={...e,finalresult:1}),(a||s)&&o instanceof HTMLMediaElement?(ne.debug("[MB:showBanner] showing banner UI on video."),this.bannerHandler.showBannerOnVideo(o,e)):(a||s)&&o instanceof HTMLAudioElement||o instanceof HTMLCanvasElement&&this.bannerHandler.showBannerOnVideo(o,e)}catch(e){ne.warn(`[MB] showBanner err, ${e.message}`)}}removeBanner(e){try{this.bannerHandler.removeBannerFromVideo(e),this.waitingRoom=this.waitingRoom.filter(t=>t.id!==e),this.status!==$&&this.detectedFinalResult[e]&&(delete this.detectedFinalResult[e],ne.debug("[MB:removeBanner] cleared dfdflagged object."))}catch(e){ne.warn(`[MB:removeBanner] err, ${e.message}`)}}removeAllBanners(){(window.audioMonitor.audioInfos||[]).forEach(({id:e=null})=>this.removeBanner(e)),this.waitingRoom=[]}}).main()})();
//# sourceMappingURL=../sourceMap/chrome/scripts/content_mb_banner.js.map